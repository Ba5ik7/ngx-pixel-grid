import { Inject, Injectable, InjectionToken, Optional } from '@angular/core';
import * as i0 from "@angular/core";
export const NGX_PIXEL_GRID_OPTIONS = new InjectionToken('NGX_PIXEL_GRID_OPTIONS');
export class NgxPixelGridService {
    constructor(options) {
        this.introAnimation = true;
        this.rows = 100;
        this.columns = 100;
        this.gutter = 1;
        this.tileSize = { width: 10, height: 10 };
        this.tileColor = 'rgb(255, 255, 255)';
        this.tileHoverColor = 'rgb(0, 0, 0)';
        if (options) {
            this.introAnimation = options.introAnimation;
            this.rows = options.rows;
            this.columns = options.columns;
            this.gutter = options.gutter;
            this.tileSize = options.tileSize;
            this.tileColor = options.tileColor;
            this.tileHoverColor = options.tileHoverColor;
        }
    }
    getPixelGridSize(tilesMatrix, gutter) {
        const width = tilesMatrix[0].length * tilesMatrix[0][0].size.width + (tilesMatrix[0].length - 1) * gutter;
        const height = tilesMatrix.length * tilesMatrix[0][0].size.height + (tilesMatrix.length - 1) * gutter;
        return { width, height };
    }
    mergeTilesMatrix(tilesMatrix, tiles) {
        tiles.forEach((tile) => {
            const tileCoordinates = tile.coordinates;
            const { x, y } = tileCoordinates;
            const _tile = tilesMatrix[x][y];
            Object.assign(_tile, {
                isPixel: true,
                img: tile.img,
                color: 'rbg(0, 0, 0)',
                href: tile.href,
                tooltipText: tile.tooltipText
            });
        });
        return tilesMatrix;
    }
    whatTileIsMouseOver(tilesMatrix, rect, event) {
        const x = event.clientX - rect.left;
        const y = event.clientY - rect.top;
        let returnTile;
        tilesMatrix.forEach((row) => {
            row.forEach((tile) => {
                if (x >= tile.coordinates.x && x <= tile.coordinates.x + tile.size.width &&
                    y >= tile.coordinates.y && y <= tile.coordinates.y + tile.size.height) {
                    returnTile = tile;
                }
            });
        });
        return returnTile ?? false;
    }
    phyllotaxisLayout(tilesMatrix, xOffset = 0, yOffset = 0, iOffset = 0) {
        // theta determines the spiral of the layout
        const theta = Math.PI * (3 - Math.sqrt(5));
        const pointRadius = this.tileSize.width / 2;
        tilesMatrix.forEach((row, i) => {
            const index = (i + iOffset) % tilesMatrix.length;
            const phylloX = pointRadius * Math.sqrt(index) * Math.cos(index * theta);
            const phylloY = pointRadius * Math.sqrt(index) * Math.sin(index * theta);
            row.forEach(tile => {
                tile.coordinates.x = xOffset + phylloX - pointRadius;
                tile.coordinates.y = yOffset + phylloY - pointRadius;
            });
        });
        return tilesMatrix;
    }
}
NgxPixelGridService.ɵfac = function NgxPixelGridService_Factory(t) { return new (t || NgxPixelGridService)(i0.ɵɵinject(NGX_PIXEL_GRID_OPTIONS, 8)); };
NgxPixelGridService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: NgxPixelGridService, factory: NgxPixelGridService.ɵfac, providedIn: 'root' });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(NgxPixelGridService, [{
        type: Injectable,
        args: [{
                providedIn: 'root'
            }]
    }], function () { return [{ type: undefined, decorators: [{
                type: Optional
            }, {
                type: Inject,
                args: [NGX_PIXEL_GRID_OPTIONS]
            }] }]; }, null); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXBpeGVsLWdyaWQuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Byb2plY3RzL25neC1waXhlbC1ncmlkL3NyYy9saWIvbmd4LXBpeGVsLWdyaWQuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxjQUFjLEVBQUUsUUFBUSxFQUFFLE1BQU0sZUFBZSxDQUFDOztBQUc3RSxNQUFNLENBQUMsTUFBTSxzQkFBc0IsR0FBRyxJQUFJLGNBQWMsQ0FBb0Isd0JBQXdCLENBQUMsQ0FBQztBQUl0RyxNQUFNLE9BQU8sbUJBQW1CO0lBRTlCLFlBQXdELE9BQTBCO1FBWWxGLG1CQUFjLEdBQVksSUFBSSxDQUFDO1FBQy9CLFNBQUksR0FBRyxHQUFHLENBQUM7UUFDWCxZQUFPLEdBQUcsR0FBRyxDQUFDO1FBQ2QsV0FBTSxHQUFHLENBQUMsQ0FBQztRQUNYLGFBQVEsR0FBVSxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxDQUFDO1FBQzVDLGNBQVMsR0FBcUIsb0JBQW9CLENBQUM7UUFDbkQsbUJBQWMsR0FBcUIsY0FBYyxDQUFDO1FBakJoRCxJQUFJLE9BQU8sRUFBRTtZQUNYLElBQUksQ0FBQyxjQUFjLEdBQUcsT0FBTyxDQUFDLGNBQWMsQ0FBQztZQUM3QyxJQUFJLENBQUMsSUFBSSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUM7WUFDekIsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDO1lBQy9CLElBQUksQ0FBQyxNQUFNLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQztZQUM3QixJQUFJLENBQUMsUUFBUSxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUM7WUFDakMsSUFBSSxDQUFDLFNBQVMsR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDO1lBQ25DLElBQUksQ0FBQyxjQUFjLEdBQUcsT0FB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QUFDO1FBRTVDLFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxFQUFFLEVBQUU7WUFDN0IsTUFBTSxLQUFLLEdBQUcsQ0FBQyxDQUFDLEdBQUcsT0FBTyxDQUFDLEdBQUcsV0FBVyxDQUFDLE1BQU0sQ0FBQztZQUNqRCxNQUFNLE9BQU8sR0FBRyxXQUFXLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUMsQ0FBQztZQUN6RSxNQUFNLE9BQU8sR0FBRyxXQUFXLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUMsQ0FBQztZQUN6RSxHQUFHLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFO2dCQUNqQixJQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsR0FBRyxPQUFPLEdBQUcsT0FBTyxHQUFHLFdBQVcsQ0FBQztnQkFDckQsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLEdBQUcsT0FBTyxHQUFHLE9BQU8sR0FBRyxXQUFXLENBQUM7WUFDdkQsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUVILE9BQU8sV0FBVyxDQUFDO0lBQ3JCLENBQUM7O3NGQTVFVSxtQkFBbUIsY0FFRSxzQkFBc0I7eUVBRjNDLG1CQUFtQixXQUFuQixtQkFBbUIsbUJBRmxCLE1BQU07dUZBRVAsbUJBQW1CO2NBSC9CLFVBQVU7ZUFBQztnQkFDVixVQUFVLEVBQUUsTUFBTTthQUNuQjs7c0JBR2MsUUFBUTs7c0JBQUksTUFBTTt1QkFBQyxzQkFBc0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3QsIEluamVjdGFibGUsIEluamVjdGlvblRva2VuLCBPcHRpb25hbCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgSEVYLCBJUGl4ZWxHcmlkT3B0aW9ucywgSVNpemUsIElUaWxlLCBSR0IsIFJHQkEgfSBmcm9tICcuL2ludGVyZmFjZXMvbmd4LXBpeGVsLWdyaWQnO1xuXG5leHBvcnQgY29uc3QgTkdYX1BJWEVMX0dSSURfT1BUSU9OUyA9IG5ldyBJbmplY3Rpb25Ub2tlbjxJUGl4ZWxHcmlkT3B0aW9ucz4oJ05HWF9QSVhFTF9HUklEX09QVElPTlMnKTtcbkBJbmplY3RhYmxlKHtcbiAgcHJvdmlkZWRJbjogJ3Jvb3QnXG59KVxuZXhwb3J0IGNsYXNzIE5neFBpeGVsR3JpZFNlcnZpY2UgaW1wbGVtZW50cyBJUGl4ZWxHcmlkT3B0aW9ucyB7XG5cbiAgY29uc3RydWN0b3IoQE9wdGlvbmFsKCkgQEluamVjdChOR1hfUElYRUxfR1JJRF9PUFRJT05TKSBvcHRpb25zOiBJUGl4ZWxHcmlkT3B0aW9ucykgeyBcbiAgICBpZiAob3B0aW9ucykge1xuICAgICAgdGhpcy5pbnRyb0FuaW1hdGlvbiA9IG9wdGlvbnMuaW50cm9BbmltYXRpb247XG4gICAgICB0aGlzLnJvd3MgPSBvcHRpb25zLnJvd3M7XG4gICAgICB0aGlzLmNvbHVtbnMgPSBvcHRpb25zLmNvbHVtbnM7XG4gICAgICB0aGlzLmd1dHRlciA9IG9wdGlvbnMuZ3V0dGVyO1xuICAgICAgdGhpcy50aWxlU2l6ZSA9IG9wdGlvbnMudGlsZVNpemU7XG4gICAgICB0aGlzLnRpbGVDb2xvciA9IG9wdGlvbnMudGlsZUNvbG9yO1xuICAgICAgdGhpcy50aWxlSG92ZXJDb2xvciA9IG9wdGlvbnMudGlsZUhvdmVyQ29sb3I7XG4gICAgfVxuICB9XG5cbiAgaW50cm9BbmltYXRpb246IGJvb2xlYW4gPSB0cnVlO1xuICByb3dzID0gMTAwO1xuICBjb2x1bW5zID0gMTAwO1xuICBndXR0ZXIgPSAxO1xuICB0aWxlU2l6ZTogSVNpemUgPSB7IHdpZHRoOiAxMCwgaGVpZ2h0OiAxMCB9O1xuICB0aWxlQ29sb3I6IFJHQiB8IFJHQkEgfCBIRVggPSAncmdiKDI1NSwgMjU1LCAyNTUpJztcbiAgdGlsZUhvdmVyQ29sb3I6IFJHQiB8IFJHQkEgfCBIRVggPSAncmdiKDAsIDAsIDApJztcblxuICBnZXRQaXhlbEdyaWRTaXplKHRpbGVzTWF0cml4OiBJVGlsZVtdW10sIGd1dHRlcjogbnVtYmVyKTogSVNpemUge1xuICAgIGNvbnN0IHdpZHRoID0gdGlsZXNNYXRyaXhbMF0ubGVuZ3RoICogdGlsZXNNYXRyaXhbMF1bMF0uc2l6ZS53aWR0aCArICh0aWxlc01hdHJpeFswXS5sZW5ndGggLSAxKSAqIGd1dHRlcjtcbiAgICBjb25zdCBoZWlnaHQgPSB0aWxlc01hdHJpeC5sZW5ndGggKiB0aWxlc01hdHJpeFswXVswXS5zaXplLmhlaWdodCArICh0aWxlc01hdHJpeC5sZW5ndGggLSAxKSAqIGd1dHRlcjtcbiAgICByZXR1cm4geyB3aWR0aCwgaGVpZ2h0IH07XG4gIH1cblxuICBtZXJnZVRpbGVzTWF0cml4KHRpbGVzTWF0cml4OiBJVGlsZVtdW10sIHRpbGVzOiBJVGlsZVtdKTogSVRpbGVbXVtdIHtcbiAgICB0aWxlcy5mb3JFYWNoKCh0aWxlOiBJVGlsZSkgPT4ge1xuICAgICAgY29uc3QgdGlsZUNvb3JkaW5hdGVzID0gdGlsZS5jb29yZGluYXRlcztcbiAgICAgIGNvbnN0IHsgeCwgeSB9ID0gdGlsZUNvb3JkaW5hdGVzO1xuICAgICAgY29uc3QgX3RpbGUgPSB0aWxlc01hdHJpeFt4XVt5XTtcbiAgICAgIE9iamVjdC5hc3NpZ24oX3RpbGUsIHtcbiAgICAgICAgaXNQaXhlbDogdHJ1ZSxcbiAgICAgICAgaW1nOiB0aWxlLmltZyxcbiAgICAgICAgY29sb3I6ICdyYmcoMCwgMCwgMCknLFxuICAgICAgICBocmVmOiB0aWxlLmhyZWYsXG4gICAgICAgIHRvb2x0aXBUZXh0OiB0aWxlLnRvb2x0aXBUZXh0XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gdGlsZXNNYXRyaXg7XG4gIH1cblxuICB3aGF0VGlsZUlzTW91c2VPdmVyKHRpbGVzTWF0cml4OiBJVGlsZVtdW10sIHJlY3Q6IERPTVJlY3QsIGV2ZW50OiBNb3VzZUV2ZW50KTogSVRpbGUgfCBib29sZWFuIHtcbiAgICBjb25zdCB4ID0gZXZlbnQuY2xpZW50WCAtIHJlY3QubGVmdDtcbiAgICBjb25zdCB5ID0gZXZlbnQuY2xpZW50WSAtIHJlY3QudG9wO1xuXG4gICAgbGV0IHJldHVyblRpbGU6IElUaWxlIHwgdW5kZWZpbmVkO1xuICAgIHRpbGVzTWF0cml4LmZvckVhY2goKHJvdykgPT4ge1xuICAgICAgcm93LmZvckVhY2goKHRpbGUpID0+IHtcbiAgICAgICAgaWYgKHggPj0gdGlsZS5jb29yZGluYXRlcy54ICYmIHggPD0gdGlsZS5jb29yZGluYXRlcy54ICsgdGlsZS5zaXplLndpZHRoICYmXG4gICAgICAgICAgICB5ID49IHRpbGUuY29vcmRpbmF0ZXMueSAmJiB5IDw9IHRpbGUuY29vcmRpbmF0ZXMueSArIHRpbGUuc2l6ZS5oZWlnaHQpIHtcbiAgICAgICAgICAgIHJldHVyblRpbGUgPSB0aWxlO1xuICAgICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiByZXR1cm5UaWxlID8/IGZhbHNlO1xuICB9XG5cbiAgcGh5bGxvdGF4aXNMYXlvdXQodGlsZXNNYXRyaXg6IElUaWxlW11bXSwgeE9mZnNldCA9IDAsIHlPZmZzZXQgPSAwLCBpT2Zmc2V0ID0gMCkge1xuICAgIC8vIHRoZXRhIGRldGVybWluZXMgdGhlIHNwaXJhbCBvZiB0aGUgbGF5b3V0XG4gICAgY29uc3QgdGhldGEgPSBNYXRoLlBJICogKDMgLSBNYXRoLnNxcnQoNSkpO1xuICAgIGNvbnN0IHBvaW50UmFkaXVzID0gdGhpcy50aWxlU2l6ZS53aWR0aCAvIDI7XG4gIFxuICAgIHRpbGVzTWF0cml4LmZvckVhY2goKHJvdywgaSkgPT4ge1xuICAgICAgY29uc3QgaW5kZXggPSAoaSArIGlPZmZzZXQpICUgdGlsZXNNYXRyaXgubGVuZ3RoO1xuICAgICAgY29uc3QgcGh5bGxvWCA9IHBvaW50UmFkaXVzICogTWF0aC5zcXJ0KGluZGV4KSAqIE1hdGguY29zKGluZGV4ICogdGhldGEpO1xuICAgICAgY29uc3QgcGh5bGxvWSA9IHBvaW50UmFkaXVzICogTWF0aC5zcXJ0KGluZGV4KSAqIE1hdGguc2luKGluZGV4ICogdGhldGEpO1xuICAgICAgcm93LmZvckVhY2godGlsZSA9PiB7XG4gICAgICAgIHRpbGUuY29vcmRpbmF0ZXMueCA9IHhPZmZzZXQgKyBwaHlsbG9YIC0gcG9pbnRSYWRpdXM7XG4gICAgICAgIHRpbGUuY29vcmRpbmF0ZXMueSA9IHlPZmZzZXQgKyBwaHlsbG9ZIC0gcG9pbnRSYWRpdXM7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgXG4gICAgcmV0dXJuIHRpbGVzTWF0cml4O1xuICB9XG59XG5cblxuXG4iXX0=